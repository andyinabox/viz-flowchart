{"version":3,"file":"viz-flowchart.js","sources":["../src/utils.js","../src/flowchart.js","../src/actor.js","../src/step.js","../src/index.js"],"sourcesContent":["export const getBandCenter = (index, band) => {\n  const start = band(index)\n  const width = band.bandwidth()\n  return start + (width/2)\n}\n\n// pretty sure there's a d3 function somewhere\n// that will do this\nexport const getActorIndex = (id, actors) => {\n  let i, index\n  for(i = 0; i < actors.length; i++){\n    if (actors[i].id === id) {\n      index = i\n      break;\n    }\n  }\n  return index\n}\n\nexport const getActorCenter = (id, actors, scale) => {\n  const index = getActorIndex(id, actors)\n  return getBandCenter(index, scale)\n}\n\nexport const isHiddenStep = (selector, currentStep) => {\n  selector.classed('hidden-step', (d, i) => (i > currentStep))\n}\n\nexport const hasActionClass = (selector, currentStep) => {\n  selector\n    .classed('action-button', (d, i) => (d.action && i === currentStep+1))\n    .classed('hidden-step', (d, i) => (i > currentStep+1))\n}\n\nexport const isActionButton = (selector) => {\n    selector.on('click', function(d) {\n      if(select(this).classed('action-button')) d.action(d)\n    })\n}\n\nexport const parseChildren = (nodes) => {\n  const data = {}\n\n  // converte NoteList to array\n  const children =  Array.prototype.slice.call(nodes);\n  \n  data.actors = children\n    .filter(c => (c.tagName.toLowerCase() === 'viz-actor'))\n    .map(a => ({\n      id: a.id,\n      title: a.innerHTML.trim()\n  }))\n  data.steps = children\n    .filter(c => (c.tagName.toLowerCase() === 'viz-step'))\n    .map(s => ({\n      from: s.getAttribute('from'),\n      to:s.getAttribute('to'),\n      desc:  s.innerHTML.trim(),\n    }))\n\n  return data\n}\n\n","import {\n  getBandCenter,\n  getActorIndex,\n  getActorCenter,\n  isHiddenStep,\n  hasActionClass,\n  isActionButton,\n  parseChildren,\n} from './utils.js'\n\nconst { \n  scaleBand,\n  scaleOrdinal,\n  range,\n  create,\n  select,\n  path,\n  schemeDark2,\n} = window.d3\n\nconst defaults = {\n  width: 800,\n  circleRadius: 15,\n  marginTop: 0,\n  marginBottom: 0,\n  marginLeft: 10,\n  marginRight: 10,\n  stepHeight: 120,\n  flowArrowSize: 10,\n  stepDescArrowSize: 13,\n}\n\nconst template = `\n<style>\nsvg {\n  width: 100%;\n  stroke-width: 1px;\n  font-family: var(--main-font-family, 'Open Sans', Helvetica, Arial, sans-serif);\n}\n\n.actor-box {\n  /* fill: #ddd; */\n  opacity: 0.5;\n  /* stroke: black; */\n}\n\n.actor-line {\n  stroke: #ddd;\n  stroke-width: 1px;\n}\n\n.actor-text {\n  fill: black;\n  text-align: center;\n  font-size: 0.75rem;\n  height: 0.75rem;\n}\n\n.hidden-step {\n  transition: fill 200ms, stroke 200ms, opacity 200ms;\n}\n\n.step-line {\n  /* stroke: black; */\n  fill: none;\n  stroke-width: 2px;\n}\n\n.step-line.hidden-step {\n  stroke: #ccc\n}\n\n/* .step-circle { */\n  /* stroke: black; */\n  /* opacity: 0.5; */\n/* } */\n\n.step-circle.hidden-step {\n  fill: white;\n  stroke: #ccc;\n}\n\n.step-number {\n  font-family: 'Open Sans', Helvetica, Arial, sans-serif;\n  fill: white;\n  line-height: 30px;\n}\n\n.step-number.hidden-step {\n  fill: #ccc;\n}\n\n.step-desc {\n  fill: black;\n}\n\n.step-desc.hidden-step {\n  fill: #ccc;\n}\n\n.step-desc.action-button {\n  fill: white;\n  font-weight: bold;\n  cursor: pointer;\n}\n\n.step-desc-bg {\n  /* fill: white; */\n  opacity: 0.5;\n}\n\n.step-desc-bg.hidden-step {\n  opacity: 0;\n  /* fill: none; */\n}\n\n.step-desc-bg.action-button {\n  opacity: 1;\n  fill: black;\n  cursor: pointer;\n}\n</style>\n<div class=\"viz-container\"></div>\n`\n\nexport default class VizFlowchart extends HTMLElement {\n  constructor() {\n    super();\n\n    // set up shadow root\n    this.attachShadow({ mode: 'open' });\n    const { actors, steps } = parseChildren(this.children);\n    this.shadowRoot.innerHTML = template;\n    const el = this.shadowRoot.querySelector('.viz-container');\n\n    Object.assign(this, {\n      el,\n      actors,\n      steps\n    })\n    // set default options\n    this.options = Object.assign({}, defaults)\n\n    this.setup()\n  }\n\n\n  static get observedAttributes() {\n    return ['step']\n  }\n\n  attributeChangedCallback() {\n    this.update()\n  }\n\n  connectedCallback() {\n    this.update()\n  }\n\n  setup() {\n\n    const {\n      el,\n      steps,\n      actors,\n    } = this\n\n    const {\n      stepHeight,\n      marginBottom,\n      marginTop,\n      width,\n    } = this.options\n\n    const actorHeight = stepHeight * .66;\n    const stepDescFontSize = stepHeight/7;\n    const height = (steps.length * stepHeight) + (actorHeight * 2) + marginTop + marginBottom;\n\n\n    Object.assign(this.options, {\n      actorHeight,\n      stepDescFontSize,\n      height,\n    })\n\n    const step = el.getAttribute('step') || steps.length-1\n    this.currentStep = parseInt(step)\n\n    this.actorsScale = scaleBand()\n      .domain(range(actors.length))\n      .range([0, width])\n      .padding(0.25)\n\n    this.stepsScale = scaleBand()\n      .domain(range(steps.length))\n      .range([stepHeight*1.5+marginTop, height])\n\n    this.colorScale = scaleOrdinal(schemeDark2)\n\n\n    const svg = create('svg')\n    svg\n      .attr('width', width)\n      .attr('height', height)\n      .attr('viewBox', `0 0 ${width} ${height}`)\n    el.appendChild(svg.node())\n    this.svg = svg\n\n    this.createActors()\n    this.updateSteps()\n  }\n\n  createActors() {\n\n    const {\n      marginTop,\n      actorHeight,\n      height,\n      marginBottom,\n    } = this.options\n\n    const {\n      svg,\n      actors,\n      actorsScale,\n      colorScale,\n    } = this\n\n    const y = marginTop\n\n    const actorsGroup = svg.append('g').attr('class', 'actors')\n\n    // tops\n    actorsGroup.append('g').attr('class', 'actor-boxes')\n      .selectAll('.actor-box')\n      .data(actors)\n      .enter().append('rect')\n        .attr('class', 'actor-box')\n        .attr('height', actorHeight)\n        .attr('width', actorsScale.bandwidth())\n        .attr('fill', (d, i) => colorScale(i))\n        .attr('x', (d, i) => actorsScale(i))\n        .attr('y',  y)\n\n    actorsGroup.append('g').attr('class', 'actor-texts')\n      .selectAll('.actor-text')\n      .data(actors)\n      .enter().append('text')\n        .attr('class', 'actor-text')\n        .attr('x', (d, i) => getBandCenter(i, actorsScale))\n        .attr('y',  y+(actorHeight/2))\n        .attr('dominant-baseline', 'middle')\n        .attr('text-anchor', 'middle')\n        .text(d => d.title)\n        \n    actorsGroup.append('g').attr('class', 'actor-lines')\n      .selectAll('.actor-line')\n      .data(actors)\n      .enter().append('line')\n        .attr('class', 'actor-line')\n        .attr('x1', (d, i) => getBandCenter(i, actorsScale))\n        .attr('x2', (d, i) => getBandCenter(i, actorsScale))\n        .attr('y1',  y+actorHeight)\n        .attr('y2', height-marginBottom-actorHeight)\n        .text(d => d.title)      \n\n    // bottoms\n    actorsGroup.append('g').attr('class', 'actor-boxes')\n      .selectAll('.actor-box')\n      .data(actors)\n      .enter().append('rect')\n        .attr('class', 'actor-box')\n        .attr('height', actorHeight)\n        .attr('width', actorsScale.bandwidth())\n        .attr('fill', (d, i) => colorScale(i))\n        .attr('x', (d, i) => actorsScale(i))\n        .attr('y',  height-marginBottom-actorHeight)\n\n    actorsGroup.append('g').attr('class', 'actor-texts')\n      .selectAll('.actor-text')\n      .data(actors)\n      .enter().append('text')\n        .attr('class', 'actor-text')\n        .attr('x', (d, i) => getBandCenter(i, actorsScale))\n        .attr('y',  height-marginBottom-actorHeight/2)\n        .attr('dominant-baseline', 'middle')\n        .attr('text-anchor', 'middle')\n        .text(d => d.title)\n  }\n\n  updateSteps() {\n\n    const {\n      svg,\n      actors,\n      steps,\n      actorsScale,\n      stepsScale,\n      currentStep,\n      colorScale,\n    } = this\n\n    const {\n      flowArrowSize,\n      circleRadius,\n      stepDescFontSize,\n    } = this.options\n\n    const stepsGroup = svg.append('g').attr('class', 'steps')\n\n    const x1 = d => getActorCenter(d.from, actors, actorsScale)\n    const x2 = d => getActorCenter(d.to, actors, actorsScale)\n    const y1 = (d, i) => stepsScale(i)\n    const isLoop = d => d.to === d.from\n\n    const drawStepLine = (d, i) => {\n      const p = path()\n      const from = getActorIndex(d.from, actors)\n      const to = getActorIndex(d.to, actors)\n\n      if (from === to) {\n        // p.moveTo(x1(d), stepsScale(i-1))\n        // p.lineTo(x2(d), stepsScale(i+1)-circleRadius)\n        p.arc(x1(d), stepsScale(i), stepsScale.bandwidth(), Math.PI/2, 3*Math.PI/2)\n      } else {\n        p.moveTo(x1(d), stepsScale(i))\n        p.lineTo(x2(d), stepsScale(i))\n        // if (i+1 < steps.length && !isLoop(steps[i+1])) p.lineTo(x2(d), stepsScale(i+1))\n      }\n\n      // arrowheads\n      if (from < to) {\n        p.moveTo(x2(d)-flowArrowSize, stepsScale(i)-flowArrowSize/2)\n        p.lineTo(x2(d), stepsScale(i))\n        p.lineTo(x2(d)-flowArrowSize, stepsScale(i)+flowArrowSize/2)\n      } else if (to < from) {\n        p.moveTo(x2(d)+flowArrowSize, stepsScale(i)-flowArrowSize/2)\n        p.lineTo(x2(d), stepsScale(i))\n        p.lineTo(x2(d)+flowArrowSize, stepsScale(i)+flowArrowSize/2)\n      } else if (to === from) {\n        // p.moveTo(x2(d)-flowArrowSize/2, stepsScale(i+1)-flowArrowSize-circleRadius)\n        // p.lineTo(x2(d), stepsScale(i+1)-circleRadius)\n        // p.lineTo(x2(d)+flowArrowSize/2, stepsScale(i+1)-flowArrowSize-circleRadius)\n      }\n\n      return p.toString()\n    }\n\n    stepsGroup.append('g').attr('class', 'step-lines')\n      .selectAll('.step-line')\n      .data(steps)\n      .join(\n        enter => enter.append('path')\n          .attr('class', 'step-line')\n          .classed('step-line-loop', d => isLoop(d))\n          .classed('step-line-normal', d => !isLoop(d))\n          .call(isHiddenStep, currentStep)\n          .attr('stroke', d => colorScale(getActorIndex(d.from, actors)))\n          .attr('d', drawStepLine),\n        update => update.call(isHiddenStep, currentStep),\n        exit => exit.remove()\n      )\n\n    stepsGroup.append('g').attr('class', 'step-circles')\n      .selectAll('.step-circle')\n      .data(steps)\n      .join(\n        enter => enter.append('circle')\n          .attr('class', 'step-circle')\n          .call(isHiddenStep, currentStep)\n          .attr('fill', d => colorScale(getActorIndex(d.from, actors)))\n          .attr('r', circleRadius)\n          .attr('cx', x1)\n          .attr('cy', y1),\n        update => update.call(isHiddenStep, currentStep),\n        exit => exit.remove()\n      )\n\n    stepsGroup.append('g').attr('class', 'step-numbers')\n      .selectAll('.step-number')\n      .data(steps)\n      .join(\n        enter => enter.append('text')\n          .attr('class', 'step-number')\n          .call(isHiddenStep, currentStep)\n          .style('font-size', `${circleRadius*1.2}px`)\n          .attr('x', x1)\n          .attr('y', (d, i) => stepsScale(i) + 2)\n          .text((d, i) => i+1)\n          .attr('dominant-baseline', 'middle')\n          .attr('text-anchor', 'middle'),\n        update => update.call(isHiddenStep, currentStep),\n        exit => exit.remove()\n      )\n    \n    stepsGroup.append('g').attr('class', 'step-desc-bgs')\n      .selectAll('.step-desc-bg')\n      .data(steps)\n      .join(\n        enter => enter.append('path')\n          .attr('class', 'step-desc-bg')\n          .call(hasActionClass, currentStep)\n          .call(this.drawStepDescriptionBox.bind(this))\n          .attr('fill', d => colorScale(getActorIndex(d.from, actors))),\n          update => update\n          .call(hasActionClass, currentStep),\n        exit => exit.remove()\n      )\n\n    stepsGroup.append('g').attr('class', 'step-descs')\n      .selectAll('.step-desc')\n      .data(steps)\n      .join(\n        enter => enter.append('text')\n          .attr('class', 'step-desc')\n          .style('font-size', stepDescFontSize+'px')\n          .call(hasActionClass, currentStep)\n          .call(isActionButton)\n          .attr('x', (svg.attr('width') / 2))\n          .attr('y', (d, i) => stepsScale(i) - stepsScale.bandwidth()/2)\n          .text(d  => d.desc)\n          .attr('dominant-baseline', 'middle')\n          .attr('text-anchor', 'middle'),\n        update => update\n          .call(hasActionClass, currentStep)\n          .call(isActionButton),\n        exit => exit.remove()\n      )\n  }\n\n  drawStepDescriptionBox(selector) {\n    const {\n      actors,\n      actorsScale,\n      stepsScale,\n    } = this\n    const {\n      stepDescArrowSize,\n      stepDescFontSize,\n      marginRight,\n      marginLeft,\n      width,\n    } = this.options\n\n    selector.attr('d', (d, i) => {\n      const p = path()\n      const top = stepsScale(i) - (stepsScale.bandwidth()/2) - stepDescFontSize\n      const bottom = top + stepDescFontSize*2\n      const arrowPointX = getActorCenter(d.from, actors, actorsScale)\n      p.moveTo(marginLeft, top)\n      p.lineTo(width-marginRight, top)\n      p.lineTo(width-marginRight, bottom)\n      p.lineTo(arrowPointX + stepDescArrowSize/2, bottom)\n      p.lineTo(arrowPointX, bottom+stepDescArrowSize)\n      p.lineTo(arrowPointX - stepDescArrowSize/2, bottom)\n      p.lineTo(marginLeft, bottom)\n      p.closePath()\n      return p.toString()\n    })\n  }\n\n  update() {\n    this.updateSteps()\n  }\n}\n","export default class VizFlowchartActor extends HTMLElement {\n  constructor() {\n    super();\n  }\n  static get observedAttributes() {\n    return ['from', 'to']\n  }\n}\n\n","export default class VizFlowchartStep extends HTMLElement {\n  constructor() {\n    super();\n  }\n  static get observedAttributes() {\n    return ['id', 'title']\n  }\n}\n","import VizFlowchart from './flowchart.js'\nimport VizFlowchartActor from './actor.js'\nimport VizFlowchartStep from './step.js'\n\ncustomElements.define('viz-actor', VizFlowchartActor);\ncustomElements.define('viz-step', VizFlowchartStep);\ncustomElements.define('viz-flowchart', VizFlowchart);\n\n\n// import { register, html, useRef, useEffect, useMemo, useCallback } from '/modules/preact.js'\n// import * as d3 from '/vendor/d3.js'\n\n// const { \n//   scaleBand,\n//   scaleOrdinal,\n//   range,\n//   create,\n//   select,\n//   path,\n//   schemeDark2,\n// } = d3\n\n\n// /*\n// const sampleData = {\n//   actors: [\n//     { id: 'user', title: 'User', },\n//     { id: 'frontend', title: 'Frontend' },\n//     { id: 'tenent',  title: 'auth0 Tenent' },\n//     { id: 'api', title: 'API' },\n//   ],\n//   steps: [\n//     { from: 'user', to: 'user', desc: 'User visits site', type: 'interaction' },\n//     { from: 'user', to: 'frontend', desc: 'User clicks on the login link', type: 'interaction', action: () => {} },\n//     { from: 'frontend', to: 'frontend', desc: 'Frontend generates code verifier and code challenge ', type: 'automation' },\n//     { from: 'frontend', to: 'tenent', desc: 'Redirect buser to /authorize with request data in query string', type: 'redirect' },\n//     { from: 'tenent', to: 'user', desc: 'User sees the login form', type: 'response' },\n//     { from: 'user', to: 'tenent', desc: 'User logs in / authenticates', type: 'interaction' },\n//     { from: 'tenent', to: 'frontend', desc: 'User is redirected back to the SPA, with authorization code', type: 'redirect' },\n//     { from: 'frontend', to: 'tenent', desc: 'Auth code + code verifier' },\n//     { from: 'tenent', to: 'tenent', desc: 'Validate code verifier and challenge' },\n//     { from: 'tenent', to: 'frontend', desc: 'ID token and access token' , action: () => {} },\n//     { from: 'frontend', to: 'api', desc: 'Request data with access token'},\n//     { from: 'api', to: 'frontend', desc: 'Response with data' },\n//     { from: 'frontend', to: 'user', desc: 'User sees data' },\n//   ]\n// }\n// */\n\n\n// function FlowsChart(props) {\n\n//   const {\n//     width = 800,\n//     circleRadius = 15,\n//     marginTop = 0,\n//     marginBottom = 0,\n//     marginLeft = 10,\n//     marginRight = 10,\n//     stepHeight = 120,\n//     children,\n//   } = props\n\n//   const data = props.data || parseChildren(children)\n\n\n//   const {\n//     actors,\n//     steps,\n//   } = data\n\n//   const step = (typeof props.step !== 'undefined') ? step : steps.length-1\n//   const actorHeight = stepHeight * .66\n\n//   const currentStep = parseInt(step)\n//   const el = useRef(null)\n//   const svgRef = useRef(create('svg'))\n//   const svg = svgRef.current\n\n//   const stepDescFontSize = useMemo(() => stepHeight/7, [stepHeight])\n//   const height = useMemo(\n//     () => parseInt(props.height) || (steps.length * stepHeight) + (actorHeight * 2) + marginTop + marginBottom,\n//     [steps, stepHeight, marginTop, marginBottom, props.height]\n//   )\n\n//   const actorsScale = useMemo(\n//     () => scaleBand()\n//       .domain(range(actors.length))\n//       .range([0, width])\n//       .padding(0.25),\n//     [actors, width],\n//   )\n\n//   const stepsScale = useMemo(\n//     () => scaleBand()\n//        .domain(range(steps.length))\n//        .range([stepHeight*1.5+marginTop, height]),\n//     [steps, stepHeight, marginTop, height]\n//   )\n\n//   useEffect(() => {\n//     if (el.current && svgRef.current) el.current.appendChild(svgRef.current.node())\n//   }, [el.current, svgRef.current])\n\n//   useEffect(() => {\n//       svg\n//         .attr('width', width)\n//         .attr('height', height)\n//         .attr('viewBox', `0 0 ${width} ${height}`)\n//   }, [width, height])\n\n  \n//   useEffect(() => {\n//     createActors(svg, actors)\n//   }, [actors])\n\n//   useEffect(() => {\n//     updateSteps(svg, steps, currentStep)\n//   }, [currentStep])\n\n//   const drawStepDescriptionBox = useCallback((selector, scale, arrowSize, fontSize) => {\n//     selector.attr('d', (d, i) => {\n//       const p = path()\n//       const top = scale(i) - (scale.bandwidth()/2) - fontSize\n//       const bottom = top + fontSize*2\n//       const arrowPointX = getActorCenter(d.from, actors, actorsScale)\n//       p.moveTo(marginLeft, top)\n//       p.lineTo(width-marginRight, top)\n//       p.lineTo(width-marginRight, bottom)\n//       p.lineTo(arrowPointX + arrowSize/2, bottom)\n//       p.lineTo(arrowPointX, bottom+arrowSize)\n//       p.lineTo(arrowPointX - arrowSize/2, bottom)\n//       p.lineTo(marginLeft, bottom)\n//       p.closePath()\n//       return p.toString()\n//     })\n//   }, [actors, width, marginLeft, marginRight])\n\n//   const createActors = useCallback((svg) => {\n//     const y = marginTop\n\n//     const actorsGroup = svg.append('g').attr('class', 'actors')\n\n//     // tops\n//     actorsGroup.append('g').attr('class', 'actor-boxes')\n//       .selectAll('.actor-box')\n//       .data(actors)\n//       .enter().append('rect')\n//         .attr('class', 'actor-box')\n//         .attr('height', actorHeight)\n//         .attr('width', actorsScale.bandwidth())\n//         .attr('fill', (d, i) => colorScale(i))\n//         .attr('x', (d, i) => actorsScale(i))\n//         .attr('y',  y)\n\n//     actorsGroup.append('g').attr('class', 'actor-texts')\n//       .selectAll('.actor-text')\n//       .data(actors)\n//       .enter().append('text')\n//         .attr('class', 'actor-text')\n//         .attr('x', (d, i) => getBandCenter(i, actorsScale))\n//         .attr('y',  y+(actorHeight/2))\n//         .attr('dominant-baseline', 'middle')\n//         .attr('text-anchor', 'middle')\n//         .text(d => d.title)\n        \n//     actorsGroup.append('g').attr('class', 'actor-lines')\n//       .selectAll('.actor-line')\n//       .data(actors)\n//       .enter().append('line')\n//         .attr('class', 'actor-line')\n//         .attr('x1', (d, i) => getBandCenter(i, actorsScale))\n//         .attr('x2', (d, i) => getBandCenter(i, actorsScale))\n//         .attr('y1',  y+actorHeight)\n//         .attr('y2', height-marginBottom-actorHeight)\n//         .text(d => d.title)      \n\n//     // bottoms\n//     actorsGroup.append('g').attr('class', 'actor-boxes')\n//       .selectAll('.actor-box')\n//       .data(actors)\n//       .enter().append('rect')\n//         .attr('class', 'actor-box')\n//         .attr('height', actorHeight)\n//         .attr('width', actorsScale.bandwidth())\n//         .attr('fill', (d, i) => colorScale(i))\n//         .attr('x', (d, i) => actorsScale(i))\n//         .attr('y',  height-marginBottom-actorHeight)\n\n//     actorsGroup.append('g').attr('class', 'actor-texts')\n//       .selectAll('.actor-text')\n//       .data(actors)\n//       .enter().append('text')\n//         .attr('class', 'actor-text')\n//         .attr('x', (d, i) => getBandCenter(i, actorsScale))\n//         .attr('y',  height-marginBottom-actorHeight/2)\n//         .attr('dominant-baseline', 'middle')\n//         .attr('text-anchor', 'middle')\n//         .text(d => d.title)\n        \n//   }, [actors, stepHeight, height, marginBottom, marginTop])\n\n//   const updateSteps = useCallback((svg, steps, currentStep) => {\n\n//     const stepsGroup = svg.append('g').attr('class', 'steps')\n\n//     const x1 = d => getActorCenter(d.from, actors, actorsScale)\n//     const x2 = d => getActorCenter(d.to, actors, actorsScale)\n//     const y1 = (d, i) => stepsScale(i)\n//     const isLoop = d => d.to === d.from\n//     const arrowSize = 10;\n\n//     const drawStepLine = (d, i) => {\n//       const p = path()\n//       const from = getActorIndex(d.from, actors)\n//       const to = getActorIndex(d.to, actors)\n\n//       if (from === to) {\n//         // p.moveTo(x1(d), stepsScale(i-1))\n//         // p.lineTo(x2(d), stepsScale(i+1)-circleRadius)\n//         p.arc(x1(d), stepsScale(i), stepsScale.bandwidth(), Math.PI/2, 3*Math.PI/2)\n//       } else {\n//         p.moveTo(x1(d), stepsScale(i))\n//         p.lineTo(x2(d), stepsScale(i))\n//         // if (i+1 < steps.length && !isLoop(steps[i+1])) p.lineTo(x2(d), stepsScale(i+1))\n//       }\n\n//       // arrowheads\n//       if (from < to) {\n//         p.moveTo(x2(d)-arrowSize, stepsScale(i)-arrowSize/2)\n//         p.lineTo(x2(d), stepsScale(i))\n//         p.lineTo(x2(d)-arrowSize, stepsScale(i)+arrowSize/2)\n//       } else if (to < from) {\n//         p.moveTo(x2(d)+arrowSize, stepsScale(i)-arrowSize/2)\n//         p.lineTo(x2(d), stepsScale(i))\n//         p.lineTo(x2(d)+arrowSize, stepsScale(i)+arrowSize/2)\n//       } else if (to === from) {\n//         // p.moveTo(x2(d)-arrowSize/2, stepsScale(i+1)-arrowSize-circleRadius)\n//         // p.lineTo(x2(d), stepsScale(i+1)-circleRadius)\n//         // p.lineTo(x2(d)+arrowSize/2, stepsScale(i+1)-arrowSize-circleRadius)\n//       }\n\n//       return p.toString()\n//     }\n\n//     stepsGroup.append('g').attr('class', 'step-lines')\n//       .selectAll('.step-line')\n//       .data(steps)\n//       .join(\n//         enter => enter.append('path')\n//           .attr('class', 'step-line')\n//           .classed('step-line-loop', d => isLoop(d))\n//           .classed('step-line-normal', d => !isLoop(d))\n//           .call(isHiddenStep, currentStep)\n//           .attr('stroke', d => colorScale(getActorIndex(d.from, actors)))\n//           .attr('d', drawStepLine),\n//         update => update.call(isHiddenStep, currentStep),\n//         exit => exit.remove()\n//       )\n\n//     stepsGroup.append('g').attr('class', 'step-circles')\n//       .selectAll('.step-circle')\n//       .data(steps)\n//       .join(\n//         enter => enter.append('circle')\n//           .attr('class', 'step-circle')\n//           .call(isHiddenStep, currentStep)\n//           .attr('fill', d => colorScale(getActorIndex(d.from, actors)))\n//           .attr('r', circleRadius)\n//           .attr('cx', x1)\n//           .attr('cy', y1),\n//         update => update.call(isHiddenStep, currentStep),\n//         exit => exit.remove()\n//       )\n\n//     stepsGroup.append('g').attr('class', 'step-numbers')\n//       .selectAll('.step-number')\n//       .data(steps)\n//       .join(\n//         enter => enter.append('text')\n//           .attr('class', 'step-number')\n//           .call(isHiddenStep, currentStep)\n//           .style('font-size', `${circleRadius*1.2}px`)\n//           .attr('x', x1)\n//           .attr('y', (d, i) => stepsScale(i) + 2)\n//           .text((d, i) => i+1)\n//           .attr('dominant-baseline', 'middle')\n//           .attr('text-anchor', 'middle'),\n//         update => update.call(isHiddenStep, currentStep),\n//         exit => exit.remove()\n//       )\n    \n//     stepsGroup.append('g').attr('class', 'step-desc-bgs')\n//       .selectAll('.step-desc-bg')\n//       .data(steps)\n//       .join(\n//         enter => enter.append('path')\n//           .attr('class', 'step-desc-bg')\n//           .call(hasActionClass, currentStep)\n//           .call(drawStepDescriptionBox, stepsScale, 13, stepDescFontSize)\n//           .attr('fill', d => colorScale(getActorIndex(d.from, actors))),\n//           update => update\n//           .call(hasActionClass, currentStep),\n//         exit => exit.remove()\n//       )\n\n//     stepsGroup.append('g').attr('class', 'step-descs')\n//       .selectAll('.step-desc')\n//       .data(steps)\n//       .join(\n//         enter => enter.append('text')\n//           .attr('class', 'step-desc')\n//           .style('font-size', stepDescFontSize+'px')\n//           .call(hasActionClass, currentStep)\n//           .call(isActionButton)\n//           .attr('x', (svg.attr('width') / 2))\n//           .attr('y', (d, i) => stepsScale(i) - stepsScale.bandwidth()/2)\n//           .text(d  => d.desc)\n//           .attr('dominant-baseline', 'middle')\n//           .attr('text-anchor', 'middle'),\n//         update => update\n//           .call(hasActionClass, currentStep)\n//           .call(isActionButton),\n//         exit => exit.remove()\n//       )\n//   }, [actors, stepDescFontSize])\n\n//   return html`\n//     <style>\n//       svg {\n//         width: 100%;\n//         stroke-width: 1px;\n//         font-family: var(--main-font-family, 'Open Sans', Helvetica, Arial, sans-serif);\n//       }\n\n//       .actor-box {\n//         /* fill: #ddd; */\n//         opacity: 0.5;\n//         /* stroke: black; */\n//       }\n\n//       .actor-line {\n//         stroke: #ddd;\n//         stroke-width: 1px;\n//       }\n\n//       .actor-text {\n//         fill: black;\n//         text-align: center;\n//         font-size: 0.75rem;\n//         height: 0.75rem;\n//       }\n\n//       .hidden-step {\n//         transition: fill 200ms, stroke 200ms, opacity 200ms;\n//       }\n\n//       .step-line {\n//         /* stroke: black; */\n//         fill: none;\n//         stroke-width: 2px;\n//       }\n\n//       .step-line.hidden-step {\n//         stroke: #ccc\n//       }\n\n//       /* .step-circle { */\n//         /* stroke: black; */\n//         /* opacity: 0.5; */\n//       /* } */\n\n//       .step-circle.hidden-step {\n//         fill: white;\n//         stroke: #ccc;\n//       }\n\n//       .step-number {\n//         font-family: 'Open Sans', Helvetica, Arial, sans-serif;\n//         fill: white;\n//         line-height: 30px;\n//       }\n\n//       .step-number.hidden-step {\n//         fill: #ccc;\n//       }\n\n//       .step-desc {\n//         fill: black;\n//       }\n\n//       .step-desc.hidden-step {\n//         fill: #ccc;\n//       }\n\n//       .step-desc.action-button {\n//         fill: white;\n//         font-weight: bold;\n//         cursor: pointer;\n//       }\n\n//       .step-desc-bg {\n//         /* fill: white; */\n//         opacity: 0.5;\n//       }\n\n//       .step-desc-bg.hidden-step {\n//         opacity: 0;\n//         /* fill: none; */\n//       }\n\n//       .step-desc-bg.action-button {\n//         opacity: 1;\n//         fill: black;\n//         cursor: pointer;\n//       }\n//     </style>\n//     <div class=\"d3-container\" ref=${el}></div>\n//   `\n// }\n\n\n// const colorScale = scaleOrdinal(schemeDark2)\n\n// const getBandCenter = (index, band) => {\n//   const start = band(index)\n//   const width = band.bandwidth()\n//   return start + (width/2)\n// }\n\n// // pretty sure there's a d3 function somewhere\n// // that will do this\n// const getActorIndex = (id, actors) => {\n//   let i, index\n//   for(i = 0; i < actors.length; i++){\n//     if (actors[i].id === id) {\n//       index = i\n//       break;\n//     }\n//   }\n//   return index\n// }\n\n// const getActorCenter = (id, actors, scale) => {\n//   const index = getActorIndex(id, actors)\n//   return getBandCenter(index, scale)\n// }\n\n// const isHiddenStep = (selector, currentStep) => {\n//   selector.classed('hidden-step', (d, i) => (i > currentStep))\n// }\n\n// const hasActionClass = (selector, currentStep) => {\n//   selector\n//     .classed('action-button', (d, i) => (d.action && i === currentStep+1))\n//     .classed('hidden-step', (d, i) => (i > currentStep+1))\n// }\n\n// const isActionButton = (selector) => {\n//     selector.on('click', function(d) {\n//       if(select(this).classed('action-button')) d.action(d)\n//     })\n// }\n\n// const parseChildren = (children) => {\n//   const data = {}\n\n//   data.actors = children\n//     .filter(a => (a.type === 'f-actor'))\n//     .map(({ props }) => ({\n//       id: props.id,\n//       title: props.children[0].trim()\n//   }))\n//   data.steps = children\n//     .filter(s => (s.type === 'f-step'))\n//     .map(({ props }) => ({\n//       from: props.from,\n//       to: props.to,\n//       desc: props.children[0].trim(),\n//     }))\n\n//   return data\n// }\n\n// function Actor() {\n//   return html``\n// }\n\n// function Step() {\n//   return html``\n// }\n\n// register(Actor, 'f-actor', ['from', 'to'])\n// register(Step, 'f-step', ['id', 'title'])\n// register(FlowsChart, 'f-chart', ['width', 'height', 'step'], { shadow: true })"],"names":["getBandCenter","index","band","bandwidth","getActorIndex","id","actors","i","length","getActorCenter","scale","isHiddenStep","selector","currentStep","classed","d","hasActionClass","action","isActionButton","on","select","this","scaleBand","scaleOrdinal","range","create","path","schemeDark2","window","d3","defaults","width","circleRadius","marginTop","marginBottom","marginLeft","marginRight","stepHeight","flowArrowSize","stepDescArrowSize","VizFlowchart","HTMLElement","[object Object]","super","attachShadow","mode","steps","nodes","data","children","Array","prototype","slice","call","filter","c","tagName","toLowerCase","map","a","title","innerHTML","trim","s","from","getAttribute","to","desc","parseChildren","shadowRoot","el","querySelector","Object","assign","options","setup","observedAttributes","update","actorHeight","stepDescFontSize","height","step","parseInt","actorsScale","domain","padding","stepsScale","colorScale","svg","attr","appendChild","node","createActors","updateSteps","y","actorsGroup","append","selectAll","enter","text","stepsGroup","x1","x2","y1","isLoop","drawStepLine","p","arc","Math","PI","moveTo","lineTo","toString","join","exit","remove","style","drawStepDescriptionBox","bind","top","bottom","arrowPointX","closePath","VizFlowchartActor","VizFlowchartStep","customElements","define"],"mappings":"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"}